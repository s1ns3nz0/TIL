# Cloud Native Spring in Action
## (부록) A.3 쿠버네티스
- 미니 큐브(minikube): 모든 운영체제에서 로컬 쿠버네티스 클러스터를 실행할 수 있다.
- 카인드(kind): 로컬 쿠버네티스 클러스터를 도커 컨테이너로 실행할 수 있다. 
- k3d(k3d): 랜처 랩에서 구현한 쿠버네티스 최소 배포판인 k3s를 기반으로 쿠버네티스 클러스터를 실행할 수 있다.
## 3. 클라우드 네이티브 개발 시작
### 3.2) 임베디드 서버로 작업
> 서버 관련 용어 정리
> - 웹 서버: 클라이언트에서 오는 HTTP 요청을 처리하고 HTTP 응답을 반환하는 서버로 아파치 HTTPD가 이에 해당한다.
> - 서블릿 컨테이너: 웹 서버의 한 구성 요소로 자바 서블릿 API를 통해 스프링 MVC 앱 같은 웹 애플리케이션의 실행 콘텍스트를 제공한다.(톰캣 카탈리나)
> - 애플리케이션 서버: 다양한 유형의 애플리케이션에 대해 완벽한 실행 환경(자카르타 EE)을 제공하고 여러 프로토콜을 지원하는 서버(와일드플라이)
#### 3.2.1) 실행 가능한 JAR 및 임베디드 서버
- 전통적인 접근법과 클라우드 네이티브 접근법의 차이점 중 하나는 애플리케이션을 패키징하고 배포하는 방법이다.
    + 전통적으로는 애플리케이션 서버나 독립형 웹 서버가 사용됐다.
    + 클라우드 네이티브 애플리케이션은 독립적이어야 하고, 실행 환경이 제공하는 서버에 의존하지 않는다.
    + 필요한 서버 기능은 애플리케이션 자체에 포함되어 조달된다. 스프링 부트는 필요한 서버 기능을 내장함으로써 외부 의존성을 제거하고 애플리케이션을 독립 실행형으로 만드는 데 일조한다. 
- 클라우드 네이티브 애플리케이션에 사용되는 내장 서버는 일반적으로 웹 서버 구성 요소와 실행 콘텍스트로 이루어져 있고 이를 통해 자바 웹 애플리케이션이 웹 서버와 상호 작용한다.
#### 3.2.2) 요청당 스레드 모델 이해
- 톰캣과 같은 서블릿 컨테이너에서 실행되는 웹 애플리케이션은 요청당 스레드(thread-per-request)라는 모델을 기반으로 요청을 처리한다.
- 각 요청에 대해 애플리케이션은 해당 특정 요청을 처리하는데만 전념할 스레드를 할당하고 요청에 대한 응답이 클라이언트에 반환할 때까지 스레드는 오직 그 목적으로만 사용하고 다른 목적으로는 사용하지 않는다.(동기화, 블로킹 처리)
- 톰캣은 스레드 풀을 초기화해서 가지고 있는데, 모든 HTTP 요청은 이 스레드 풀을 통해 관리한다. 새로운 요청이 들어왔는데 모든 스레드가 사용 중이라면 그 요청은 큐로 들어가 스레드 하나가 사용 가능한 상태로 풀릴 때까지 기다린다. 
- 즉, 톰캣의 스레드 수는 동시에 들어오는 요청을 지원할 수 있는 상한선이 된다.
- 스레드를 소진하는 경우가 많이 발생하면 스레드 풀에 대한 설정을 변경해 더 많은 요청을 할 수 있다.
### 3.3 스프링 MVC를 이용한 RESTful 애플리케이션 구축
- 클라우드 네이티브 애플리케이션을 구축하면 시스템 전반적인 기능을 위해 상호작용하는 여러 마이크로서비스로 구성된 분산 시스템을 개발할 가능성이 높다.
- 개발한 애플리케이션이 조직 내 다른 팀이 개발한 서비스에 의해 사용될 수도 있다.
#### 3.3.1 REST API를 먼저, 비즈니스 로직은 그 다음
- API 우선 원칙을 채택하면 애플리케이션을 발전시켜 나가고 미래의 요구 사항에 맞춰 적응하기가 쉽다.
- 비즈니스 로직의 3가지 중심 개념
    + 개체: 개체는 책처럼, 한 도메인에서 명사를 나타낸다.
    + 서비스: 도메인에 대한 사용 사례를 정의하고 구한현다.
    + 리포지터리: 도메인 계층으로 하여금 데이터 소스와 독립적으로 데이터에 액세스하기 위한 추상화 계층
